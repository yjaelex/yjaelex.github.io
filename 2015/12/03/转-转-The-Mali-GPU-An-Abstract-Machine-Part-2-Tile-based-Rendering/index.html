<!-- build time:Thu Dec 29 2016 17:20:15 GMT+0800 (China Standard Time) --><!DOCTYPE HTML><html lang="zh-CN"><head><meta charset="UTF-8"><title>[转][转] The Mali GPU: An Abstract Machine, Part 2 - Tile-based Rendering-蓝天和白云的博客</title><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><meta name="author" content="Alex"><meta name="keywords" content="计算机图形, yjaelex, 蓝天和白云"><meta name="google-site-verification" content="9lcaJdZKsghYWk19tQSzSIdlKxsT0jta8L0Qnc2WLSM"><meta name="description" content="第二篇，介绍了Tile-based rendering。一样有中英文对照。1. 英文原文In my&amp;nbsp;previousblog&amp;nbsp;I started defining an abstract machine which can be used to describe the application-visible behaviors of the Mali GPU and driv"><meta property="og:type" content="article"><meta property="og:title" content="[转][转] The Mali GPU: An Abstract Machine, Part 2 - Tile-based Rendering"><meta property="og:url" content="http://yjaelex.github.io/2015/12/03/转-转-The-Mali-GPU-An-Abstract-Machine-Part-2-Tile-based-Rendering/index.html"><meta property="og:site_name" content="蓝天和白云的博客"><meta property="og:description" content="第二篇，介绍了Tile-based rendering。一样有中英文对照。1. 英文原文In my&amp;nbsp;previousblog&amp;nbsp;I started defining an abstract machine which can be used to describe the application-visible behaviors of the Mali GPU and driv"><meta property="og:image" content="https://community.arm.com/servlet/JiveServlet/downloadImage/38-2804-7077/model-imr.png"><meta property="og:image" content="https://community.arm.com/servlet/JiveServlet/downloadImage/38-2804-7079/model-tbr.png"><meta property="og:image" content="https://community.arm.com/servlet/JiveServlet/downloadImage/38-2804-7080/blogentry-107443-087661400+1345199231_thumb.png"><meta property="og:image" content="https://community.arm.com/servlet/JiveServlet/downloadImage/38-3305-8424/model-imr.png"><meta property="og:image" content="https://community.arm.com/servlet/JiveServlet/downloadImage/38-3305-8425/model-tbr.png"><meta property="og:image" content="https://community.arm.com/servlet/JiveServlet/downloadImage/38-3305-8426/blogentry-107443-087661400+1345199231_thumb.png"><meta property="og:updated_time" content="2016-12-29T08:41:45.281Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="[转][转] The Mali GPU: An Abstract Machine, Part 2 - Tile-based Rendering"><meta name="twitter:description" content="第二篇，介绍了Tile-based rendering。一样有中英文对照。1. 英文原文In my&amp;nbsp;previousblog&amp;nbsp;I started defining an abstract machine which can be used to describe the application-visible behaviors of the Mali GPU and driv"><meta name="twitter:image" content="https://community.arm.com/servlet/JiveServlet/downloadImage/38-2804-7077/model-imr.png"><link rel="alternative" href="/atom.xml" title="蓝天和白云的博客" type="application/atom+xml"><link rel="icon" href="/img/favicon.ico"><link rel="apple-touch-icon" href="/img/jacman.jpg"><link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg"><link rel="stylesheet" href="/css/style.css"></head></html><body><header><div><div id="imglogo"><a href="/"><img src="/img/logo.png" alt="蓝天和白云的博客" title="蓝天和白云的博客"></a></div><div id="textlogo"><h1 class="site-name"><a href="/" title="蓝天和白云的博客">蓝天和白云的博客</a></h1><h2 class="blog-motto">一个计算机图形爱好者</h2></div><div class="navbar"><a class="navbutton navmobile" href="#" title="菜单"></a></div><nav class="animated"><ul><ul><li><a href="/">首页</a></li><li><a href="/archives">归档</a></li><li><a href="/about">关于</a></li><li><form class="search" action="http://zhannei.baidu.com/cse/search" target="_blank"><label>Search</label><input name="s" type="hidden" value="6862289814022638000"><input type="text" name="q" size="30" placeholder="搜索"><br></form></li></ul></ul></nav></div></header><div id="container"><div id="main" class="post" itemscope itemprop="blogPost"><article itemprop="articleBody"><header class="article-info clearfix"><h1 itemprop="name"><a href="/2015/12/03/转-转-The-Mali-GPU-An-Abstract-Machine-Part-2-Tile-based-Rendering/" title="[转][转] The Mali GPU: An Abstract Machine, Part 2 - Tile-based Rendering" itemprop="url">[转][转] The Mali GPU: An Abstract Machine, Part 2 - Tile-based Rendering</a></h1><p class="article-author">By <a href="/about" title="Alex" target="_blank" itemprop="author">Alex</a></p><p class="article-time"><time datetime="2015-12-03T02:05:18.000Z" itemprop="datePublished">发表于 2015-12-03</time></p></header><div class="article-content"><div id="toc" class="toc-article"><strong class="toc-title">文章目录</strong><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-英文原文"><span class="toc-number">1.</span> <span class="toc-text">1. 英文原文</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-中文翻译"><span class="toc-number">2.</span> <span class="toc-text">2. 中文翻译</span></a></li></ol></div><p>第二篇，介绍了Tile-based rendering。一样有中英文对照。</p><h2 id="1-英文原文"><a href="#1-英文原文" class="headerlink" title="1. 英文原文"></a>1. 英文原文</h2><p>In my&nbsp;<a href="https://community.arm.com/groups/arm-mali-graphics/blog/2014/02/03/the-mali-gpu-an-abstract-machine-part-1" rel="external nofollow noopener noreferrer" target="_blank">previous<br>blog</a>&nbsp;I started defining an abstract machine which can be used to describe the application-visible behaviors of the Mali GPU and driver software. The purpose of this machine is to give developers a mental model of the interesting behaviors beneath the OpenGL<br>ES API, which can in turn be used to explain issues which impact their application’s performance. I will use this model in the future blogs of this series to explore some common performance pot-holes which developers encounter when developing graphics applications.</p><p>&nbsp;</p><p>This blog continues the development of this abstract machine, looking at the tile-based rendering model of the Mali GPU family. I’ll assume you’ve read the first blog on pipelining; if you haven’t I would suggest reading that first.</p><p>&nbsp;</p><a id="more"></a><p>##<br>The “Traditional” Approach</p><p>&nbsp;</p><p>In a traditional mains-powered desktop GPU architecture — commonly called an immediate mode architecture — the fragment shaders are executed on each primitive, in each draw call, in sequence. Each primitive is rendered to completion before starting the next<br>one, with an algorithm which approximates to:</p><p>&nbsp;</p><div class="dp-highlighter" style="padding:1px 0 0;border:0;font-family:Consolas,'Courier New',Courier,mono,serif;vertical-align:baseline;width:auto;overflow:visible;color:#565b5b;line-height:25px;margin:0!important;background-color:#e7e5dc"><br><div class="bar" style="margin:0;padding:0 0 0 45px;border:0;font-weight:inherit;font-style:inherit;font-family:inherit;vertical-align:baseline"><br><div style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-family:inherit;vertical-align:baseline"><br></div><br></div><ol><li><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;vertical-align:baseline;color:#000;font-size:9pt!important;background-color:inherit"><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;vertical-align:baseline;font-size:9pt!important;background-color:inherit">&nbsp;&nbsp;&nbsp;&nbsp;foreach(&nbsp;primitive&nbsp;)&nbsp;&nbsp;</span></span></li><li><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;vertical-align:baseline;color:#000;font-size:9pt!important;background-color:inherit">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach(&nbsp;fragment&nbsp;)&nbsp;&nbsp;</span></li><li><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;vertical-align:baseline;color:#000;font-size:9pt!important;background-color:inherit">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;render&nbsp;fragment&nbsp;&nbsp;</span><br></li></ol></div><p><span lang="EN-US" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-family:inherit;vertical-align:baseline"></span></p><p></p><p>As any triangle in the stream may cover any part of the screen the working set of data maintained by these renderers is large; typically at least a full-screen size color buffer, depth buffer, and possibly a stencil buffer too. A typical working set for a modern<br>device will be 32 bits-per-pixel (bpp) color, and 32bpp packed depth/stencil. A 1080p display therefore has a working set of 16MB, and a 4k2k TV has a working set of 64MB.&nbsp; Due to their size these working buffers must be stored off-chip in a DRAM.</p><p>&nbsp;</p><p><a href="https://community.arm.com/servlet/JiveServlet/showImage/38-2804-7077/model-imr.png" rel="external nofollow noopener noreferrer" target="_blank"><img src="https://community.arm.com/servlet/JiveServlet/downloadImage/38-2804-7077/model-imr.png" alt="model-imr.png"></a></p><p>&nbsp;</p><p>Every blending, depth testing, and stencil testing operation requires the current value of the data for the current fragment’s pixel coordinate to be fetched from this working set. All fragments shaded will typically touch this working set, so at high resolutions<br>the bandwidth load placed on this memory can be exceptionally high, with multiple read-modify-write operations per fragment, although caching can mitigate this slightly. This need for high bandwidth access in turn drives the need for a wide memory interface<br>with lots of pins, as well as specialized high-frequency memory, both of which result in external memory accesses which are particularly energy intensive.</p><p>&nbsp;</p><p>##<br>The Mali Approach</p><p>&nbsp;</p><p>The Mali GPU family takes a very different approach, commonly called tile-based rendering, designed to minimize the amount of power hungry external memory accesses which are needed during rendering. As described in&nbsp;<a href="https://community.arm.com/groups/arm-mali-graphics/blog/2014/02/03/the-mali-gpu-an-abstract-machine-part-1" rel="external nofollow noopener noreferrer" target="_blank">the<br>first blog</a>&nbsp;in this series, Mali uses a distinct two-pass rendering algorithm for each render target. It first executes all of the geometry processing, and then executes all of the fragment processing. During the geometry processing stage, Mali GPUs break<br>up the screen into small 16x16 pixel tiles and construct a list of which rendering primitives are present in each tile. When the GPU fragment shading step runs, each shader core processes one 16x16 pixel tile at a time, rendering it to completion before starting<br>the next one. For tile-based architectures the algorithm equates to:</p><p>&nbsp;</p><div class="dp-highlighter" style="padding:1px 0 0;border:0;font-family:Consolas,'Courier New',Courier,mono,serif;vertical-align:baseline;width:auto;overflow:visible;color:#565b5b;line-height:25px;margin:0!important;background-color:#e7e5dc"><br><div class="bar" style="margin:0;padding:0 0 0 45px;border:0;font-weight:inherit;font-style:inherit;font-family:inherit;vertical-align:baseline"><br><div style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-family:inherit;vertical-align:baseline"><br></div><br></div><ol><li><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;vertical-align:baseline;color:#000;font-size:9pt!important;background-color:inherit"><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;vertical-align:baseline;font-size:9pt!important;background-color:inherit">&nbsp;&nbsp;&nbsp;&nbsp;foreach(&nbsp;tile&nbsp;)&nbsp;&nbsp;</span></span></li><li><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;vertical-align:baseline;color:#000;font-size:9pt!important;background-color:inherit">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach(&nbsp;primitive&nbsp;in&nbsp;tile&nbsp;)&nbsp;&nbsp;</span></li><li><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;vertical-align:baseline;color:#000;font-size:9pt!important;background-color:inherit">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach(&nbsp;fragment&nbsp;in&nbsp;primitive&nbsp;in&nbsp;tile&nbsp;)&nbsp;&nbsp;</span></li><li><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;vertical-align:baseline;color:#000;font-size:9pt!important;background-color:inherit">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;render&nbsp;fragment&nbsp;&nbsp;</span><br></li></ol></div><p>&nbsp;</p><p>As a 16x16 tile is only a small fraction of the total screen area it is possible to keep the entire working set (color, depth, and stencil) for a whole tile in a fast RAM which is tightly coupled with the GPU shader core.</p><p><a href="https://community.arm.com/servlet/JiveServlet/showImage/38-2804-7079/model-tbr.png" rel="external nofollow noopener noreferrer" target="_blank"><img src="https://community.arm.com/servlet/JiveServlet/downloadImage/38-2804-7079/model-tbr.png" alt="model-tbr.png"></a></p><p>&nbsp;</p><p>This tile-based approach has a number of advantages. They are mostly transparent to the developer but worth knowing about, in particular when trying to understand bandwidth costs of your content:</p><p>&nbsp;</p><ul><li>All accesses to the working set are local accesses, which is both fast and low power. The power consumed reading or writing to an external DRAM will vary with system design, but it can easily be around 120mW for each 1GByte/s of bandwidth provided. Internal<br>memory accesses are approximately an order of magnitude less energy intensive than this, so you can see that this really does matter.</li><li>Blending is both fast and power-efficient, as the destination color data required for many blend equations is readily available.</li><li>A tile is sufficiently small that we can actually store enough samples locally in the tile memory to allow 4x, 8x and 16x&nbsp;<a href="https://community.arm.com/external-link.jspa?url=http%3A%2F%2Fen.wikipedia.org%2Fwiki%2FMultisample_anti-aliasing" rel="external nofollow noopener noreferrer" target="_blank">multisample<br>antialising</a><sup>1</sup>. This provides high quality and very low overhead anti-aliasing. Due to the size of the working set involved (4, 8 or 16 times that of a normal single-sampled render target; a massive 1GB of working set data is needed for 16x MSAA<br>for a 4k2k display panel) few immediate mode renderers even offer MSAA as a feature to developers, because the external memory footprint and bandwidth normally make it prohibitively expensive.</li><li>Mali only has to write the color data for a single tile back to memory at the end of the tile, at which point we know its final state. We can compare the block’s color with the current data in main memory via a CRC check — a process called&nbsp;<a href="https://community.arm.com/external-link.jspa?url=http%3A%2F%2Fwww.arm.com%2Fproducts%2Fmultimedia%2Fmali-technologies%2Ftransaction-elimination.php" rel="external nofollow noopener noreferrer" target="_blank">Transaction<br>Elimination</a>&nbsp;— skipping the write completely if the tile contents are the same, saving SoC power. My colleague&nbsp;<a href="https://community.arm.com/people/tomolson" rel="external nofollow noopener noreferrer" target="_blank">tomolson</a>&nbsp;has<br>written a&nbsp;<a href="https://community.arm.com/groups/arm-mali-graphics/blog/2012/08/17/how-low-can-you-go-building-low-power-low-bandwidth-arm-mali-gpus" rel="external nofollow noopener noreferrer" target="_blank">great<br>blog</a>&nbsp;on this technology, complete with a real world example of Transaction Elimination (some game called Angry Birds; you might have heard of it). I’ll let Tom’s blog explain this technology in more detail, but here is a sneak peek of the technology in<br>action (only the “extra pink” tiles were written by the GPU - all of the others were successfully discarded).</li></ul><p><span lang="EN-US" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-family:inherit;vertical-align:baseline">&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://community.arm.com/servlet/JiveServlet/showImage/38-2804-7080/blogentry-107443-087661400&#43;1345199231_thumb.png" rel="external nofollow noopener noreferrer" target="_blank"><img src="https://community.arm.com/servlet/JiveServlet/downloadImage/38-2804-7080/blogentry-107443-087661400&#43;1345199231_thumb.png" alt="blogentry-107443-087661400 1345199231_thumb.png"></a></span></p><p><span lang="EN-US" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-family:inherit;vertical-align:baseline"></span></p><p></p><ul><li>We can compress the color data for the tiles which survive Transaction Elimination using a fast, lossless, compression scheme —&nbsp;<a href="https://community.arm.com/external-link.jspa?url=http%3A%2F%2Fwww.arm.com%2Fproducts%2Fmultimedia%2Fmali-technologies%2Farm-frame-buffer-compression.php" rel="external nofollow noopener noreferrer" target="_blank">ARM<br>Frame Buffer Compression</a>&nbsp;(AFBC) — allowing us to lower the bandwidth and power consumed even further. This compression can be applied to offscreen FBO render targets, which can be read back as textures in subsequent rendering passes by the GPU, as well<br>as the main window surface, provided there is an AFBC compatible display controller such as&nbsp;<a href="https://community.arm.com/external-link.jspa?url=http%3A%2F%2Fwww.arm.com%2Fproducts%2Fmultimedia%2Fmali-display%2Fmali-dp500.php" rel="external nofollow noopener noreferrer" target="_blank">Mali-DP500</a>&nbsp;in<br>the system.</li><li>Most content has a depth and stencil buffer, but doesn’t need to keep their contents once the frame rendering has finished. If developers tell the Mali drivers that depth and stencil buffers do not need to be preserved<sup>2</sup>&nbsp;— ideally via a call to&nbsp;<span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-family:'courier new',courier;vertical-align:baseline">glDiscardFramebufferEXT</span>&nbsp;(OpenGL<br>ES 2.0) or<span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-family:'courier new',courier;vertical-align:baseline">glInvalidateFramebuffer</span>&nbsp;(OpenGL ES 3.0), although it can be inferred by the drivers in some<br>cases — then the depth and stencil content of tile is never written back to main memory at all. Another big bandwidth and power saving!</li></ul><p>&nbsp;</p><p>It is clear from the list above that tile-based rendering carries a number of advantages, in particular giving very significant reductions in the bandwidth and power associated with framebuffer data, as well as being able to provide low-cost anti-aliasing.<br>What is the downside?</p><p>&nbsp;</p><p>The principal additional overhead of any tile-based rendering scheme is the point of hand-over from the vertex shader to the fragment shader. The output of the geometry processing stage, the per-vertex varyings and tiler intermediate state, must be written<br>out to main memory and then re-read by the fragment processing stage. There is therefore a balance to be struck between costing extra bandwidth for the varying data and tiler state, and saving bandwidth for the framebuffer data.</p><p>&nbsp;</p><p>In modern consumer electronics today there is a significant shift towards higher resolution displays; 1080p is now normal for smartphones, tablets such as the Mali-T604 powered Google Nexus 10 are running at WQXGA (2560x1600), and 4k2k is becoming the new “must<br>have” in the television market. Screen resolution, and hence framebuffer bandwidth, is growing fast. In this area Mali really shines, and does so in a manner which is mostly transparent to the application developer - you get all of these goodies for free with<br>no application changes!</p><p>&nbsp;</p><p>On the geometry side of things, Mali copes well with complexity. Many high-end benchmarks are approaching a million triangles a frame, which is an order of magnitude (or two) more complex than popular gaming applications on the Android app stores. However,<br>as the intermediate geometry data does hit main memory there are some useful tips and tricks which can be applied to fine tune the GPU performance, and get the best out of the system. These are worth an entire blog by themselves, so we’ll cover these at a<br>later point in this series.</p><p>&nbsp;</p><p>##<br>Summary</p><p>&nbsp;</p><p>In this blog I have compared and contrasted the desktop-style immediate mode renderer, and the tile-based approach used by Mali, looking in particular at the memory bandwidth implications of both.</p><p>&nbsp;</p><p>Tune in next time and I’ll finish off the definition of the abstract machine, looking at a simple block model of the Mali shader core itself. Once we have that out of the way we can get on with the useful part of the series: putting this model to work and earning<br>a living optimizing your applications running on Mali.</p><p>&nbsp;</p><p><span style="margin:0;padding:0;border:0;font-style:inherit;font-family:inherit;vertical-align:baseline">Note:</span>&nbsp;The next blog in this series has now been published:&nbsp;<a href="https://community.arm.com/groups/arm-mali-graphics/blog/2014/03/12/the-mali-gpu-an-abstract-machine-part-3--the-shader-core" rel="external nofollow noopener noreferrer" target="_blank">The<br>Mali GPU: An Abstract Machine, Part 3 - The Shader Core</a></p><p>&nbsp;</p><p>As always comments and questions more than welcome,</p><p>Pete</p><p>&nbsp;</p><p>##<br>Footnotes</p><p>&nbsp;</p><ol><li>Exactly which multisampling options are available depends on the GPU. The recently announced&nbsp;<a href="https://community.arm.com/external-link.jspa?url=http%3A%2F%2Fwww.arm.com%2Fproducts%2Fmultimedia%2Fmali-high-end-graphics%2Fmali-t760.php" rel="external nofollow noopener noreferrer" target="_blank">Mali-T760<br>GPU</a>&nbsp;includes support for up to 16x MSAA.</li><li>The depth and stencil discard is automatic for EGL window surfaces, but for offscreen render targets they may be preserved and reused in a future rendering operation.<br>3.</li></ol><h2 id="2-中文翻译"><a href="#2-中文翻译" class="headerlink" title="2. 中文翻译"></a>2. 中文翻译</h2><p><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">在<span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:13.33px;vertical-align:baseline">我</span></span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-family:Arial,sans-serif;vertical-align:baseline;color:windowtext"><u><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#0481a5"><a href="https://community.arm.com/community/arm-cc-cn/blog/2014/06/06/mali-gpu-%E6%8A%BD%E8%B1%A1%E6%9C%BA%E5%99%A8-%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86-%E5%B8%A7%E7%AE%A1%E7%BA%BF%E5%8C%96" rel="external nofollow noopener noreferrer" target="_blank">上一篇博文</a></span></u></span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-family:inherit;vertical-align:baseline"><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">中</span></span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">，我开始定义一台抽象机器，用于描述</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline;color:#000">&nbsp;Mali<br>GPU<span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline">和驱动程序软件对应用程序可见的行为。此机器的用意是为开发人员提供</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;vertical-align:baseline">&nbsp;OpenGL</span></span></p><p>ES API&nbsp;<span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline">下有趣行为的一个心智模型，而这反过来也可用于解释影响其应用程序性能的问题。我在本系列后面几篇博文中继续使用这一模型，探讨开发人员在开发图形应用程序时常常遇到的一些性能缺口。</span></p><p><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">这篇博文将继续开发这台抽象机器，探讨</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline;color:#000">&nbsp;Mali<br>GPU<span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline">系列基于区块的渲染模型。你应该已经阅读了关于管线化的第一篇博文；如果还没有，建议你先读一下。</span></span></p><p>##</p><p><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:15pt;font-family:SimSun;vertical-align:baseline;color:#4e5584">“传统”方式</span></p><p><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">在传统的主线驱动型桌面</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline;color:#000">&nbsp;GPU&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">架构中</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline;color:#000">&nbsp;—&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">通常称为直接模式架构</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline;color:#000">&nbsp;—&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">片段着色器按照顺序在每一绘制调用、每一原语上执行。每一原语渲染结束后再开始下一个，其利用类&#20284;于如下所示的算法：</span></p><p><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:9pt;font-family:Arial,sans-serif;vertical-align:baseline;color:#000">1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:9pt;font-family:Arial,sans-serif;vertical-align:baseline;color:#000">&nbsp;&nbsp;&nbsp;<br>foreach( primitive )&nbsp;</span></p><p><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:9pt;font-family:Arial,sans-serif;vertical-align:baseline;color:#000">2.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:9pt;font-family:Arial,sans-serif;vertical-align:baseline;color:#000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>foreach( fragment )&nbsp;</span></p><p><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:9pt;font-family:Arial,sans-serif;vertical-align:baseline;color:#000">3.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:9pt;font-family:Arial,sans-serif;vertical-align:baseline;color:#000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>render fragment&nbsp;</span></p><p><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">由于流中的任何三角形可能会覆盖屏幕的任何部分，由这些渲染器维护的数据工作集将会很大；通常至少包含全屏尺寸颜色缓冲、深度缓冲，还可能包含模板缓冲。现代设备的典型工作集是</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline;color:#000">&nbsp;32&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">位</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline;color:#000">/</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">像素</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline;color:#000">&nbsp;(bpp)&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">颜色，以及</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline;color:#000">&nbsp;32<br>bpp&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">封装的深度</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline;color:#000">/</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">模板。因此，</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline;color:#000">1080p&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">显示屏拥有一个</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline;color:#000">&nbsp;16MB&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">工作集，而</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline;color:#000">&nbsp;4k2k&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">电视机则有一个</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline;color:#000">64MB&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">工作集。由于其大小原因，这些工作缓冲必须存储在芯片外的</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline;color:#000">&nbsp;DRAM&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">中。</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-family:Arial,sans-serif;vertical-align:baseline"></span></p><p></p><div style="margin:0;padding:0;border:0;font-size:14px;font-family:'Gill Sans Alt One WGL W01 Lt';vertical-align:baseline;color:#565b5b;line-height:25px"><br><br><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-family:Arial,sans-serif;vertical-align:baseline"><a href="https://community.arm.com/servlet/JiveServlet/showImage/38-3305-8424/model-imr.png" rel="external nofollow noopener noreferrer" target="_blank"><img src="https://community.arm.com/servlet/JiveServlet/downloadImage/38-3305-8424/model-imr.png" alt="model-imr.png"></a><br><br></span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">每一次混合、深度测试和模板测试运算都需要从这一工作集中获取当前片段像素坐标的数据&#20540;。被着色的所有片段通常会接触到这一工作集，因此在高清显示中，置于这一内存上的带宽负载可能会特别高，每一片段也都有多个读</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline;color:#000">-</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">改</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline;color:#000">-</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">写运算，尽管缓存可能会稍稍缓减这一问题。这一对高带宽存取的需求反过来推动了对具备许多针脚的宽内存接口和专用高频率内存的需求，这两者都会造成能耗特别密集的外部内存访问。</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-family:Arial,sans-serif;vertical-align:baseline"><br><br></span><br><br><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:15pt;font-family:Arial,sans-serif;vertical-align:baseline;color:#4e5584">Mali&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:15pt;font-family:SimSun;vertical-align:baseline;color:#4e5584">方式</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-family:Arial,sans-serif;vertical-align:baseline"><br><br></span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline;color:#000">Mali GPU&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">系列采用非常不同的方式，通常称为基于区块的的渲染，其设计宗旨是竭力减少渲染期间所需的功耗巨大的外部内存访问。如本系列</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-family:Arial,sans-serif;vertical-align:baseline"><a href="https://community.arm.com/groups/arm-mali-graphics/blog/2014/02/03/the-mali-gpu-an-abstract-machine-part-1" rel="external nofollow noopener noreferrer" target="_blank"><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#0481a5">第一篇博文</span></a></span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-family:inherit;vertical-align:baseline"><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">中</span></span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">所述，</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline;color:#000">Mali&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">对每一渲染目标使用独特的两步骤渲染算法。它首先执行全部的几何处理，然后执行所有的片段处理。在几何处理阶段中，</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline;color:#000">Mali<br>GPU&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">将屏幕分割为微小的</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline;color:#000">&nbsp;16x16&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">像素区块，并对每个区块中存在的渲染原语构建一份清单。</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline;color:#000">GPU&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">片段着色步骤开始时，每一着色器核心一次处理一个</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline;color:#000">&nbsp;16x16&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">像素区块，将它渲染完后再开始下一区块。对于基于区块的架构，其算法相当于：</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-family:Arial,sans-serif;vertical-align:baseline"><br><br></span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:9pt;font-family:Arial,sans-serif;vertical-align:baseline;color:#000">1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:9pt;font-family:Arial,sans-serif;vertical-align:baseline;color:#000">&nbsp;&nbsp;&nbsp;<br>foreach( tile )&nbsp;&nbsp;</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-family:Arial,sans-serif;vertical-align:baseline"><br><br></span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:9pt;font-family:Arial,sans-serif;vertical-align:baseline;color:#000">2.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:9pt;font-family:Arial,sans-serif;vertical-align:baseline;color:#000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>foreach( primitive in tile )&nbsp;</span><br><br><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:9pt;font-family:Arial,sans-serif;vertical-align:baseline;color:#000">3.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:9pt;font-family:Arial,sans-serif;vertical-align:baseline;color:#000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>foreach( fragment in primitive in tile )&nbsp;&nbsp;</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-family:Arial,sans-serif;vertical-align:baseline"><br><br></span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:9pt;font-family:Arial,sans-serif;vertical-align:baseline;color:#000">4.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:9pt;font-family:Arial,sans-serif;vertical-align:baseline;color:#000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>render fragment&nbsp;&nbsp;</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-family:Arial,sans-serif;vertical-align:baseline"><br><br></span><br><div style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-family:inherit;vertical-align:baseline"><br><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">由于</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline;color:#000">&nbsp;16x16&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">区块仅仅是总屏幕面积的一小部分，所以有可能将整个区块的完整工作集（颜色、深度和模板）存放在和</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline;color:#000">&nbsp;GPU&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">着色器核心紧密耦合的快速</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline;color:#000">&nbsp;RAM</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">中。</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-family:Arial,sans-serif;vertical-align:baseline"><br><br></span></div><br><div style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-family:inherit;vertical-align:baseline"><br><a href="https://community.arm.com/servlet/JiveServlet/showImage/38-3305-8425/model-tbr.png" rel="external nofollow noopener noreferrer" target="_blank"><img src="https://community.arm.com/servlet/JiveServlet/downloadImage/38-3305-8425/model-tbr.png" alt="model-tbr.png"></a></div><br><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-family:Arial,sans-serif;vertical-align:baseline"><br><br></span><br><div style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-family:inherit;vertical-align:baseline"><br><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">这种基于区块的方式有诸多优势。它们大体上对开发人员透明，但也&#20540;得了解，尤其是在尝试了解你内容的带宽成本时：</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-family:Arial,sans-serif;vertical-align:baseline"><br><br></span></div><br><div style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-family:inherit;vertical-align:baseline"><br><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Symbol;vertical-align:baseline;color:#000"><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline">对工作集的所有访问都属于本地访问，速度快、功耗低。读取或写入外部</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline">&nbsp;DRAM&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline">的功耗因系统设计而异，但对于提供的每</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline">&nbsp;1GB/s&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline">带宽，它很容易达到大约</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline">120mW</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline">。与这相比，内部内存访问的功耗要大约少一个数量级，所以你会发现这真的大有关系。</span></span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-family:Arial,sans-serif;vertical-align:baseline"><br><br></span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Symbol;vertical-align:baseline;color:#000"><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline">混合不仅速度快，而且功耗低，因为许多混合方式需要的目标颜色数据都随时可用。</span></span></div><br><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Symbol;vertical-align:baseline;color:#000"><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline">区块足够小，我们实际上可以在区块内存中本地存储足够数量的样本，实现</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline">&nbsp;4&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline">倍、</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline">8&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline">倍和</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline">&nbsp;16&nbsp;</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:13.33px;font-family:inherit;vertical-align:baseline"><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline">倍</span></span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline"><a href="https://community.arm.com/external-link.jspa?url=http%3A%2F%2Fen.wikipedia.org%2Fwiki%2FMultisample_anti-aliasing" rel="external nofollow noopener noreferrer" target="_blank"><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:13.33px;font-family:SimSun;vertical-align:baseline;color:#0481a5">多采样抗锯齿</span></a></span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline"><sup>1</sup></span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline">。这可提供质量高、开销很低的抗锯齿。由于涉及的工作集大小（一般单一采样渲染目标的</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline">&nbsp;4</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline">、</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline">8&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline">或</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline">&nbsp;16&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline">倍；</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline">4k2k&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline">显示面板的</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline">&nbsp;16x<br>MSAA<span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline">需要巨大的</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;vertical-align:baseline">&nbsp;1GB&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline">工作集数据），少数直接模式渲染器甚至将</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;vertical-align:baseline">&nbsp;MSAA</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline">作为一项功能提供给开发人员，因为外部内存大小和带宽通常导致其成本过于高昂。</span></span></span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-family:Arial,sans-serif;vertical-align:baseline"><br><br></span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Symbol;vertical-align:baseline;color:#000"><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline">Mali&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline">仅仅需要将单一区块的颜色数据写回到区块末尾的内存，此时我们便能知道其最终状态。我们可以通过</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline">&nbsp;CRC&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline">检查将块的颜色与主内存中的当前数据进行比较</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline">&nbsp;—&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline">这一过程叫做</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline">“</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:13.33px;font-family:Arial,sans-serif;vertical-align:baseline"><a href="https://community.arm.com/external-link.jspa?url=http%3A%2F%2Fwww.arm.com%2Fproducts%2Fmultimedia%2Fmali-technologies%2Ftransaction-elimination.php" rel="external nofollow noopener noreferrer" target="_blank"><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#0481a5">事务消除</span></a></span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline">”</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline">—&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline">如果区块内容相同，则可完全跳过写出，从而节省了</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline">&nbsp;SoC&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline">功耗。我的同事</span>&nbsp;<span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:13.33px;font-family:Arial,sans-serif;vertical-align:baseline"><a href="https://community.arm.com/people/tomolson" rel="external nofollow noopener noreferrer" target="_blank"><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:inherit;vertical-align:baseline;color:#0481a5">Tom<br>Olson</span></a></span>&nbsp;<span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline">针对这一技术写了<span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:13.33px;vertical-align:baseline">一篇</span></span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:13.33px;font-family:Arial,sans-serif;vertical-align:baseline"><a href="https://community.arm.com/groups/arm-mali-graphics/blog/2012/08/17/how-low-can-you-go-building-low-power-low-bandwidth-arm-mali-gpus" rel="external nofollow noopener noreferrer" target="_blank">&nbsp;<span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#0481a5">优秀的博文</span></a></span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:13.33px;font-family:inherit;vertical-align:baseline"><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline">，</span></span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline">文中还提供了</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline">“</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline">事务消除</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline">”</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline">的一个现实世界示例（某个名叫</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline">“</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline">愤怒的小鸟</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline">”</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline">的游戏；你或许听说过）。有关这一技术的详细信息还是由</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline">&nbsp;Tom&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline">的博文来介绍；不过，这儿也稍稍了解一下该技术的运用（仅</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline">“</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline">多出的粉色</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline">”</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline">区块由</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline">&nbsp;GPU&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline">写入</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline">&nbsp;-&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline">其他全被成功丢弃）。</span></span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-family:Arial,sans-serif;vertical-align:baseline"><br><br></span><br><div style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-family:inherit;vertical-align:baseline"><br>&nbsp;&nbsp;&nbsp;&nbsp;<a href="https://community.arm.com/servlet/JiveServlet/showImage/38-3305-8426/blogentry-107443-087661400&#43;1345199231_thumb.png" rel="external nofollow noopener noreferrer" target="_blank"><img src="https://community.arm.com/servlet/JiveServlet/downloadImage/38-3305-8426/blogentry-107443-087661400&#43;1345199231_thumb.png" alt="blogentry-107443-087661400&#43;1345199231_thumb.png"></a><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-family:Arial,sans-serif;vertical-align:baseline"><br><br></span></div><br><div style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-family:inherit;vertical-align:baseline"><br><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Symbol;vertical-align:baseline;color:#000"><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline">我们可以采用快速的无损压缩方案</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline">&nbsp;—&nbsp;</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:13.33px;font-family:Arial,sans-serif;vertical-align:baseline"><a href="https://community.arm.com/external-link.jspa?url=http%3A%2F%2Fwww.arm.com%2Fproducts%2Fmultimedia%2Fmali-technologies%2Farm-frame-buffer-compression.php" rel="external nofollow noopener noreferrer" target="_blank"><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:inherit;vertical-align:baseline;color:#0481a5">ARM&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#0481a5">帧缓冲压缩</span></a></span>&nbsp;<span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline">(AFBC)<br>—&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline">，对逃过事务消除的区块的颜色数据进行压缩，从而进一步降低带宽和功耗。这一压缩可以应用到离屏</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline">&nbsp;FBO&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline">渲染目标，后者可在随后的渲染步骤中由</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline">&nbsp;GPU&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline">作为纹理读回；也可以应用到主窗口表面，只要系统中存在兼容</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline">&nbsp;AFBC&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline">的显示控制器，如</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:13.33px;font-family:Arial,sans-serif;vertical-align:baseline"><a href="https://community.arm.com/external-link.jspa?url=http%3A%2F%2Fwww.arm.com%2Fproducts%2Fmultimedia%2Fmali-display%2Fmali-dp500.php" rel="external nofollow noopener noreferrer" target="_blank"><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:inherit;vertical-align:baseline;color:#0481a5">Mali-DP500</span></a></span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline">。</span></span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-family:Arial,sans-serif;vertical-align:baseline"><br><br></span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Symbol;vertical-align:baseline;color:#000"><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline">大多数内容拥有深度缓冲和模板缓冲，但帧渲染结束后就不必再保留其内容。如果开发人员告诉</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline">&nbsp;Mali&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline">驱动程序不需要保留深度缓冲和模板缓冲</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline"><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;vertical-align:baseline"><sup>2</sup></span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;vertical-align:baseline">—&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline">理想方式是通过调用</span>&nbsp;&nbsp;<span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;vertical-align:baseline">glDiscardFramebufferEXT<br>(OpenGL ES 2.0)&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline">或</span>&nbsp;<span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;vertical-align:baseline">glInvalidateFramebuffer<br>(OpenGLES 3.0)</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline">，虽然在某些情形中可由驱动程序推断</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;vertical-align:baseline">&nbsp;—&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline">那么区块的深度内容和模板内容也就彻底不用写回到主内存中。我们又大幅节省了带宽和功耗！</span></span></span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-family:Arial,sans-serif;vertical-align:baseline"><br><br></span><br><div style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-family:inherit;vertical-align:baseline"><br><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">上表中可以清晰地看出，基于区块的渲染具有诸多优势，尤其是可以大幅降低与帧缓冲数据相关的带宽和功耗，而且还能够提供低成本的抗锯齿功能。那么，有些什么劣势呢？</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-family:Arial,sans-serif;vertical-align:baseline"><br><br></span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">任何基于区块的渲染方案的主要额外开销是从顶点着色器到片段着色器的交接点。几何处理阶段的输出、各顶点可变数和区块中间状态必须写出到主内存，再由片段处理阶段重新读取。因此，必须要在可变数据和区块状态消耗的额外带宽与帧缓冲数据节省的带宽之间取得平衡。</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-family:Arial,sans-serif;vertical-align:baseline"><br><br></span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">当今的现代消费类电子设备正大步向更高分辨率显示屏迈进；</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline;color:#000">1080p&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">现在已是智能手机的常态，配备</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline;color:#000"><br><br>Mali-T604&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">的</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline;color:#000">&nbsp;Google<br>Nexus 10&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">等平板电脑以</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline;color:#000">&nbsp;WQXGA<br>(2560x1600)&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">分辨率运行，而</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline;color:#000">&nbsp;4k2k&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">正逐渐成为电视机市场上新的</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline;color:#000">“</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">不二之选</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline;color:#000">”</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">。屏幕分辨率以及帧缓冲带宽正快速发展。在这一方面，</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline;color:#000">Mali&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">确实表现出众，而且以对应用程序开发人员基本透明的方式实现</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline;color:#000">&nbsp;-&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">无需任何代价，就能获得所有这些好处，而且还不用更改应用程序！</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-family:Arial,sans-serif;vertical-align:baseline"><br><br></span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">在几何处理方面，</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline;color:#000">Mali&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">也能处理好复杂度。许多高端基准测试正在接近每帧百万个三角形，其复杂度比</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline;color:#000">&nbsp;Android&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">应用商店中的热门游戏应用程序高出一个（或两个）数量级。然而，由于中间几何数据的确到达主内存，所以可以应用一些有用的技巧和诀窍，来优化</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline;color:#000">&nbsp;GPU&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">性能并充分发挥系统能力。这些技巧&#20540;得通过一篇博文来细谈，所以我们会在这一系列的后续博文中再予以介绍。</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-family:Arial,sans-serif;vertical-align:baseline"><br><br></span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:15pt;font-family:SimSun;vertical-align:baseline;color:#4e5584">小结</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-family:Arial,sans-serif;vertical-align:baseline"><br><br></span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">在这篇博文中，我比较了桌面型直接模式渲染器与</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline;color:#000">&nbsp;Mali&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">所用的基于区块方式的异同，尤其探讨了两种方式对内存带宽的影响。</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-family:Arial,sans-serif;vertical-align:baseline"><br><br></span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">敬请期待下一篇博文。我将通过介绍</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline;color:#000">&nbsp;Mali&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">着色器核心本身的简单块模型，完成对这一抽象机器的定义。理解这部分内容后，我们就能继续介绍系列博文的其他有用部分：将这一模型应用到实践中，使其发挥实际作用，优化你在</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline;color:#000">&nbsp;Mali&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">上运行的应用程序。</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-family:Arial,sans-serif;vertical-align:baseline"><br><br></span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">注意：</span>&nbsp;<span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">本系列的下一篇博文已经发布：</span>&nbsp;<span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-family:Arial,sans-serif;vertical-align:baseline"><a href="https://community.arm.com/groups/arm-mali-graphics/blog/2014/03/12/the-mali-gpu-an-abstract-machine-part-3--the-shader-core" rel="external nofollow noopener noreferrer" target="_blank"><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:inherit;vertical-align:baseline;color:#0481a5">Mali<br>GPU:&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#0481a5">抽象机器，第</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:inherit;vertical-align:baseline;color:#0481a5">3</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#0481a5">部分</span>&nbsp;<span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:inherit;vertical-align:baseline;color:#0481a5">–&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#0481a5">着色器核心</span></a></span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-family:Arial,sans-serif;vertical-align:baseline"><br><br></span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">与往常一样，欢迎提出任何意见和问题。</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-family:Arial,sans-serif;vertical-align:baseline"><br><br></span></div><br><div style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-family:inherit;vertical-align:baseline"><br><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline;color:#000">Pete</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-family:Arial,sans-serif;vertical-align:baseline"><br><br></span></div><br><div style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-family:inherit;vertical-align:baseline"><br><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:15pt;font-family:SimSun;vertical-align:baseline;color:#4e5584">脚注</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-family:Arial,sans-serif;vertical-align:baseline"><br><br></span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline;color:#000"><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline">具体有哪些多采样选项可用要视</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;vertical-align:baseline">&nbsp;GPU&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline">而定。最近推出的</span>&nbsp;<span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:13.33px;vertical-align:baseline"><a href="https://community.arm.com/external-link.jspa?url=http%3A%2F%2Fwww.arm.com%2Fproducts%2Fmultimedia%2Fmali-high-end-graphics%2Fmali-t760.php" rel="external nofollow noopener noreferrer" target="_blank"><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:inherit;vertical-align:baseline;color:#0481a5">Mali-T760<br>GPU</span></a></span>&nbsp;<span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline">最高支持</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;vertical-align:baseline">&nbsp;16&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline">倍</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;vertical-align:baseline">&nbsp;MSAA</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline">。</span></span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-family:Arial,sans-serif;vertical-align:baseline"><br><br></span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">对</span><span style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:Arial,sans-serif;vertical-align:baseline;color:#000">&nbsp;EGL&nbsp;</span><span lang="ZH-CN" style="margin:0;padding:0;border:0;font-weight:inherit;font-style:inherit;font-size:10pt;font-family:SimSun;vertical-align:baseline;color:#000">窗口表面而言，深度丢弃与模板丢弃是自动执行的；但对于离屏渲染对象，它们可能会予以保留，供将来的渲染运算重新利用。</span></div><br></div><br></div><p><br>本文地址 <a href="http://yjaelex.github.io/2015/12/03/转-转-The-Mali-GPU-An-Abstract-Machine-Part-2-Tile-based-Rendering/">http://yjaelex.github.io/2015/12/03/转-转-The-Mali-GPU-An-Abstract-Machine-Part-2-Tile-based-Rendering/</a> 作者为<a href="/about/"> Alex</a></p></div><div style="font-size:16px;BORDER-BOTTOM:#bbb 1px solid;BORDER-LEFT:#bbb 1px solid;BACKGROUND:#f6f6f6;MIN-HEIGHT:120px;BORDER-TOP:#bbb 1px solid;BORDER-RIGHT:#bbb 1px solid;MARGIN-LEFT:10px;MARGIN-RIGHT:10px;MARGIN-BOTTOM:10px" class="oec2003right"><div style="MARGIN-TOP:10px;FLOAT:left;MARGIN-LEFT:10px;MARGIN-RIGHT:10px"><img alt="author:Alex" src="http://yjaelex.github.io/imgs/myself.jpg" width="100" height="100"></div><div style="LINE-HEIGHT:200%;MARGIN:10px;COLOR:#000">Author: <a href="https://www.linkedin.com/in/yjaelex" rel="external nofollow noopener noreferrer" target="_blank">Alex</a> &nbsp&nbsp&nbsp&nbsp Blog: <a href="http://yjaelex.github.io/">http://yjaelex.github.io/</a>&nbsp&nbsp&nbsp&nbsp Email: <a href="mailto:yjaelex@163.com" rel="external nofollow noopener noreferrer" target="_blank">yjaelex@163.com</a><br>I have almost 9 years of professional 3D graphics development experiences(D3D/OpenGL) and have solid experience of graphics driver developement, for both DirectX and OpenGL/ES.</div></div><footer class="article-footer clearfix"><div class="article-catetags"></div><div class="article-share" id="share"><div data-url="http://yjaelex.github.io/2015/12/03/转-转-The-Mali-GPU-An-Abstract-Machine-Part-2-Tile-based-Rendering/" data-title="[转][转] The Mali GPU: An Abstract Machine, Part 2 - Tile-based Rendering | 蓝天和白云的博客" data-tsina="undefined" class="share clearfix"></div></div></footer></article><nav class="article-nav clearfix"><div class="prev"><a href="/2015/12/03/转-转-The-Mali-GPU-An-Abstract-Machine-Part-3-The-Shader-Core/" title="[转][转]The Mali GPU: An Abstract Machine, Part 3 - The Shader Core"><strong>上一篇：</strong><br><span>[转][转]The Mali GPU: An Abstract Machine, Part 3 - The Shader Core</span></a></div><div class="next"><a href="/2015/12/03/转-转-The-Mali-GPU-An-Abstract-Machine-Part-1-Frame-Pipelining/" title="[转][转]The Mali GPU: An Abstract Machine, Part 1 - Frame Pipelining"><strong>下一篇：</strong><br><span>[转][转]The Mali GPU: An Abstract Machine, Part 1 - Frame Pipelining</span></a></div></nav><section id="comments" class="comment"><div class="ds-thread" data-thread-key="2015/12/03/转-转-The-Mali-GPU-An-Abstract-Machine-Part-2-Tile-based-Rendering/" data-title="[转][转] The Mali GPU: An Abstract Machine, Part 2 - Tile-based Rendering" data-url="http://yjaelex.github.io/2015/12/03/转-转-The-Mali-GPU-An-Abstract-Machine-Part-2-Tile-based-Rendering/"></div></section></div><div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div><div id="toc" class="toc-aside"><strong class="toc-title">文章目录</strong><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-英文原文"><span class="toc-number">1.</span> <span class="toc-text">1. 英文原文</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-中文翻译"><span class="toc-number">2.</span> <span class="toc-text">2. 中文翻译</span></a></li></ol></div><div id="asidepart"><div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div><aside class="clearfix"><div class="github-card"><p class="asidetitle">Github 名片</p><div class="github-card" data-github="yjaelex" data-width="220" data-height="119" data-theme="medium"><script type="text/javascript" src="//cdn.jsdelivr.net/github-cards/latest/widget.js"></script></div></div><div class="tagcloudlist"><p class="asidetitle">标签云</p><div class="tagcloudlist clearfix"><a href="/tags/Graphics/" style="font-size:10px">Graphics</a> <a href="/tags/Mantle/" style="font-size:10px">Mantle</a></div></div><div class="archiveslist"><p class="asidetitle"><a href="/archives">归档</a></p><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">十二月 2015</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/11/">十一月 2015</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/09/">九月 2015</a><span class="archive-list-count">4</span></li></ul></div><div class="tagslist"><p class="asidetitle">标签</p><ul class="clearfix"><li><a href="/tags/Mantle/" title="Mantle">Mantle<sup>1</sup></a></li><li><a href="/tags/Graphics/" title="Graphics">Graphics<sup>1</sup></a></li></ul></div><div class="hotarticles"><p class="asidetitle">热评文章</p><div class="ds-top-threads" data-range="monthly" data-num-items="5"></div></div><div class="linkslist"><p class="asidetitle">友情链接</p><ul><li><a href="http://blog.csdn.net/qwertyu1234" target="_blank" title="蓝天和白云的CSDN博客">蓝天和白云的CSDN博客</a></li><li><a href="https://github.com/yjaelex/" target="_blank" title="Alex&#39;s Github" rel="external nofollow noopener noreferrer">Alex&#39;s Github</a></li></ul></div><div class="rsspart"><a href="/atom.xml" target="_blank" title="rss">RSS 订阅</a></div></aside></div></div><footer><div id="footer"><div class="line"><span></span><div class="author"></div></div><section class="info"><p>图形学爱好者的家园<br></p></section><div class="social-font"><a href="https://github.com/yjaelex" target="_blank" class="icon-github" title="github" rel="external nofollow noopener noreferrer"></a> <a href="https://www.linkedin.com/in/yjaelex" target="_blank" class="icon-linkedin" title="linkedin" rel="external nofollow noopener noreferrer"></a> <a href="mailto:yjaelex@163.com" target="_blank" class="icon-email" title="Email Me" rel="external nofollow noopener noreferrer"></a></div><p class="copyright">Copyright ©2014-2016 <a href="/about" target="_blank" title="Alex">Alex</a></p></div><script type="text/javascript">var cnzz_protocol="https:"==document.location.protocol?" https://":" http://";document.write(unescape("%3Cspan style='display:none;' id='cnzz_stat_icon_1260545070'%3E%3C/span%3E%3Cscript src='"+cnzz_protocol+"s95.cnzz.com/z_stat.php%3Fid%3D1260545070' type='text/javascript'%3E%3C/script%3E"))</script><script type="text/javascript">!function(t,e,n,s,c,i,a){t.SwiftypeObject=c,t[c]=t[c]||function(){(t[c].q=t[c].q||[]).push(arguments)},i=e.createElement(n),a=e.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","//s.swiftypecdn.com/install/v2/st.js","_st"),_st("install","qFtymqNnfXjgmwxAJxMP","2.0.0")</script></footer><script src="/js/jquery-2.0.3.min.js"></script><script src="/js/jquery.imagesloaded.min.js"></script><script src="/js/gallery.js"></script><script src="/js/jquery.qrcode-0.12.0.min.js"></script><script type="text/javascript">$(document).ready(function(){function e(){"number"==typeof window.innerWidth?n=window.innerWidth:document.documentElement&&document.documentElement.clientWidth&&(n=document.documentElement.clientWidth)}$(".navbar").click(function(){$("header nav").toggleClass("shownav")});var n=0,s=$("#main"),a=$("#asidepart"),o=$(".closeaside"),d=$(".openaside");o.click(function(){a.addClass("fadeOut").css("display","none"),d.css("display","block").addClass("fadeIn"),s.addClass("moveMain")}),d.click(function(){d.css("display","none").removeClass("beforeFadeIn"),a.css("display","block").removeClass("fadeOut").addClass("fadeIn"),s.removeClass("moveMain")}),$(window).scroll(function(){d.css("top",Math.max(80,260-$(this).scrollTop()))}),$(window).resize(function(){e(),n>=1024?$("header nav").removeClass("shownav"):(s.removeClass("moveMain"),a.css("display","block").removeClass("fadeOut"),d.css("display","none"),$("#toc.toc-aside").css("display","none"))})})</script><script type="text/javascript">$(document).ready(function(){var c=$(".article-content>iframe"),n=$(".article-content>embed"),o=($("#toc"),$("#toc.toc-aside")),e=$(".openaside"),i=$(".closeaside");c.length>0&&c.wrap('<div class="video-container" />'),n.length>0&&n.wrap('<div class="video-container" />'),i.click(function(){o.css("display","block").addClass("fadeIn")}),e.click(function(){o.css("display","none")}),$(window).scroll(function(){o.css("top",Math.max(140,320-$(this).scrollTop()))})})</script><script type="text/javascript">$(document).ready(function(){function e(){"number"==typeof window.innerWidth?n=window.innerWidth:document.documentElement&&document.documentElement.clientWidth&&(n=document.documentElement.clientWidth);var e=n>1024?200:100,t={render:"image",size:e,fill:"#2ca6cb",text:r,radius:.5,quiet:1},a=$(".article-share-qrcode").position();$(".hoverqrcode").empty().css("width",e).css("height",e).css("left",a.left-e/2+20).css("top",a.top-e-10).qrcode(t)}var t=$(".share"),r=t.attr("data-url"),a=encodeURIComponent(r),i=t.attr("data-title"),c=t.attr("data-tsina"),o=(t.attr("description"),['<div class="hoverqrcode clearfix"></div>','<a class="overlay" id="qrcode"></a>','<a href="https://www.facebook.com/sharer.php?u='+a+'" class="article-share-facebook" target="_blank" title="Facebook"></a>','<a href="https://twitter.com/intent/tweet?url='+a+'" class="article-share-twitter" target="_blank" title="Twitter"></a>','<a href="#qrcode" class="article-share-qrcode" title="微信"></a>','<a href="http://widget.renren.com/dialog/share?resourceUrl='+a+"&srcUrl="+a+"&title="+i+'" class="article-share-renren" target="_blank" title="人人"></a>','<a href="http://service.weibo.com/share/share.php?title='+i+"&url="+a+"&ralateUid="+c+'&searchPic=true&style=number" class="article-share-weibo" target="_blank" title="微博"></a>','<span title="Share to"></span>'].join(""));t.append(o),$(".hoverqrcode").hide();var n=0;$(window).resize(function(){$(".hoverqrcode").hide()}),$(".article-share-qrcode").click(function(){e(),$(".hoverqrcode").toggle()}),$(".article-share-qrcode").hover(function(){},function(){$(".hoverqrcode").hide()})})</script><script type="text/javascript">var duoshuoQuery={short_name:"yjaelexblog"};!function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//static.duoshuo.com/embed.js",e.charset="UTF-8",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)}()</script><link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css"><script src="/fancybox/jquery.fancybox.pack.js"></script><script type="text/javascript">$(document).ready(function(){$(".article-content").each(function(a){$(this).find("img").each(function(){if(!$(this).parent().hasClass("fancybox")){var a=this.alt;a&&$(this).after('<span class="caption">'+a+"</span>"),$(this).wrap('<a href="'+this.src+'" title="'+a+'" class="fancybox"></a>')}}),$(this).find(".fancybox").each(function(){$(this).attr("rel","article"+a)})}),$.fancybox&&$(".fancybox").fancybox()})</script><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="//hm.baidu.com/hm.js?202299ed0711ed4f90ea1e0b0fd936f1";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><div id="totop"><a title="返回顶部"><img alt="返回顶部" src="/img/scrollup.png"></a></div><script src="/js/totop.js"></script></body><!-- rebuild by neat -->